!function(){function e(e,t){for(;e.parentNode;){var n=e;if(e=e.parentNode,e.id===t)return n}return null}function t(){4==this.readyState&&200==this.status&&(s.open("GET","/board"),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send(),s.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText);for(var t in e){var r=document.getElementById(t);null!==r&&(r.innerHTML=e[t])}n(e["player-move-description"]),n(e["computer-move-description"]),c.style.zIndex=1,c.innerHTML=e["player-move-description"]+"<hr>"+e["computer-move-description"],c.className="show",a=setTimeout(function(){c.style.zIndex=-1,c.className=""},5500)}})}function n(e){if("undefined"!=typeof SpeechSynthesisUtterance){h=new SpeechSynthesisUtterance,h.onend=function(){};var t=window.speechSynthesis;return h.text=e,t.speak(h),!0}return!1}for(var a,r=document.querySelectorAll("input"),o=(document.querySelectorAll("#played-cards > li"),document.forms[0]),s=new XMLHttpRequest,d=document.getElementById("overlay"),i=document.getElementById("overlay-text"),c=document.getElementById("notification"),u=0;u<r.length;u++){var l=r[u];l.addEventListener("dragover",function(e){this.checked=!0,e.preventDefault()}),l.addEventListener("drop",function(e){e.preventDefault();var t=e.dataTransfer.getData("card"),n=document.getElementsByClassName(t)[0];o.dataset.button=n.value,n.click()})}document.addEventListener("dragstart",function(e){"BUTTON"===e.target.nodeName&&e.dataTransfer.setData("card",e.target.className)}),document.addEventListener("dragenter",function(t){var n=e(t.target,"played-cards");n&&(n.className+=" hover-played",document.querySelector("input[value=play]").checked=!0)}),document.addEventListener("dragover",function(t){var n=e(t.target,"played-cards");n&&t.preventDefault()}),document.addEventListener("dragleave",function(t){var n=e(t.target,"played-cards");n&&(n.className=n.className.replace(" hover-played",""))}),document.addEventListener("drop",function(e){if("played-cards"===e.target.parentNode.id||"played-cards-stack"==e.target.parentNode.className){e.preventDefault();var t=e.dataTransfer.getData("card"),n=document.getElementsByClassName(t)[0];o.dataset.button=n.value,n.click()}}),document.addEventListener("click",function(e){if("BUTTON"===e.target.nodeName||"BUTTON"===e.target.parentNode.nodeName){var t="BUTTON"===e.target.nodeName?e.target:e.target.parentNode;o.dataset.button=t.value,o.dataset.color=t.className.match(/color\-(red|white|blue|green|yellow)/)[1],o.dataset.number=t.className.match(/number\-([1-5])/)[1]}if("undefined"!=typeof e.target.dataset.show){var r=document.getElementById(e.target.dataset.show).outerHTML;"shown"==d.className?(d.className="",i.innerHTML=""):(i.innerHTML=r,d.className="shown"),e.preventDefault()}"overlay"!==e.target.id&&"overlay-dismiss"!==e.target.className||(d.className="",e.preventDefault()),"notification"===e.target.id&&(c.style.zIndex=-1,c.className="",clearTimeout(a)),"overlay-read"===e.target.className&&(n(i.innerText),e.preventDefault())}),o.addEventListener("submit",function(e){var n=document.querySelector("input:checked").value;o.dataset.color,o.dataset.number;s.onreadystatechange=t,s.open("POST","/gameplay"),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send("action="+n+"&card="+o.dataset.button),e.preventDefault()});var p=function(e){var t={addEvent:function(e,t,n,a){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&(e["e"+t+n]=n,e[t+n]=function(){e["e"+t+n](window.event,a)},e.attachEvent("on"+t,e[t+n]))},input:"",pattern:"38384040373937396665",load:function(e){this.addEvent(document,"keydown",function(n,a){if(a&&(t=a),t.input+=n?n.keyCode:event.keyCode,t.input.length>t.pattern.length&&(t.input=t.input.substr(t.input.length-t.pattern.length)),t.input==t.pattern)return t.code(e),t.input="",n.preventDefault(),!1},this),this.iphone.load(e)},code:function(e){window.location=e},iphone:{start_x:0,start_y:0,stop_x:0,stop_y:0,tap:!1,capture:!1,orig_keys:"",keys:["UP","UP","DOWN","DOWN","LEFT","RIGHT","LEFT","RIGHT","TAP","TAP"],code:function(e){t.code(e)},load:function(e){this.orig_keys=this.keys,t.addEvent(document,"touchmove",function(e){if(1==e.touches.length&&1==t.iphone.capture){var n=e.touches[0];t.iphone.stop_x=n.pageX,t.iphone.stop_y=n.pageY,t.iphone.tap=!1,t.iphone.capture=!1,t.iphone.check_direction()}}),t.addEvent(document,"touchend",function(n){1==t.iphone.tap&&t.iphone.check_direction(e)},!1),t.addEvent(document,"touchstart",function(e){t.iphone.start_x=e.changedTouches[0].pageX,t.iphone.start_y=e.changedTouches[0].pageY,t.iphone.tap=!0,t.iphone.capture=!0})},check_direction:function(e){x_magnitude=Math.abs(this.start_x-this.stop_x),y_magnitude=Math.abs(this.start_y-this.stop_y),x=this.start_x-this.stop_x<0?"RIGHT":"LEFT",y=this.start_y-this.stop_y<0?"DOWN":"UP",result=x_magnitude>y_magnitude?x:y,result=1==this.tap?"TAP":result,result==this.keys[0]&&(this.keys=this.keys.slice(1,this.keys.length)),0==this.keys.length&&(this.keys=this.orig_keys,this.code(e))}}};return"string"==typeof e&&t.load(e),"function"==typeof e&&(t.code=e,t.load()),t};new p(function(){for(var e=document.querySelectorAll("#hand-player .card"),t=0;t<e.length;t++)e[t].className+=" color-known-true number-known-true"});document.addEventListener("keydown",function(e){27===e.keyCode&&(d.className="")});var h=!1;"undefined"!=typeof SpeechSynthesisUtterance&&(document.querySelector(".overlay-read").className="overlay-read")}();