!function(){function e(e,t){for(;e.parentNode;){var n=e;if(e=e.parentNode,e.id===t)return n}return null}function t(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText);for(var t in e){var n=document.getElementById(t);null!==n&&(n.innerHTML=e[t])}a("<div class='player-move'>"+e["player-move-description"]+"</div><div class='computer-move'>"+e["computer-move-description"]+"</div>",!0)}}function n(e){if("undefined"!=typeof SpeechSynthesisUtterance){"undefined"!=typeof window.speechSynthesis&&window.speechSynthesis.cancel(),m=new SpeechSynthesisUtterance,m.onend=function(){};var t=window.speechSynthesis;return m.text=e,t.speak(m),!0}return!1}function a(e,t){u.style.zIndex=1,u.innerHTML=e,u.className="show";var a=u.innerText,r=a.length>150?14e3:7500;t&&n(a),clearTimeout(s),s=setTimeout(function(){u.style.zIndex=-1,u.className="","undefined"!=typeof window.speechSynthesis&&window.speechSynthesis.cancel()},r)}for(var s,r=document.querySelectorAll("input"),o=(document.querySelectorAll("#played-cards > li"),document.forms[0]),d=new XMLHttpRequest,i=document.getElementById("overlay"),c=document.getElementById("overlay-text"),u=document.getElementById("notification"),l=0;l<r.length;l++){var p=r[l];p.addEventListener("dragover",function(e){this.checked=!0,e.preventDefault()}),p.addEventListener("drop",function(e){e.preventDefault();var t=e.dataTransfer.getData("card"),n=document.getElementsByClassName(t)[0];o.dataset.button=n.value,n.click()})}document.addEventListener("dragstart",function(e){"BUTTON"===e.target.nodeName&&e.dataTransfer.setData("card",e.target.className)}),document.addEventListener("dragenter",function(t){var n=e(t.target,"played-cards");n&&(n.className+=" hover-played",document.querySelector("input[value=play]").checked=!0)}),document.addEventListener("dragover",function(t){var n=e(t.target,"played-cards");n&&t.preventDefault()}),document.addEventListener("dragleave",function(t){var n=e(t.target,"played-cards");n&&(n.className=n.className.replace(" hover-played",""))}),document.addEventListener("drop",function(e){if("played-cards"===e.target.parentNode.id||"played-cards-stack"==e.target.parentNode.className){e.preventDefault();var t=e.dataTransfer.getData("card"),n=document.getElementsByClassName(t)[0];o.dataset.button=n.value,n.click()}}),document.addEventListener("click",function(t){if("BUTTON"===t.target.nodeName||"BUTTON"===t.target.parentNode.nodeName){var a="BUTTON"===t.target.nodeName?t.target:t.target.parentNode;o.dataset.button=a.value,o.dataset.color=a.className.match(/color\-(red|white|blue|green|yellow)/)[1],o.dataset.number=a.className.match(/number\-([1-5])/)[1]}if("undefined"!=typeof t.target.dataset.show){var r=t.target.dataset.show,d=document.getElementById(r).outerHTML;"shown"==i.className&&i.dataset.id===r||(c.innerHTML=d,i.className="shown",i.dataset.id=r),t.preventDefault()}("overlay"===t.target.id||"overlay-dismiss"===t.target.className||t.target.dataset.dismiss)&&(i.className="",t.preventDefault()),("notification"===t.target.id||e(t.target,"notification"))&&(u.style.zIndex=-1,u.className="",clearTimeout(s),"undefined"!=typeof window.speechSynthesis&&window.speechSynthesis.cancel()),"overlay-read"===t.target.className&&(n(c.innerText),t.preventDefault())}),o.addEventListener("submit",function(e){var n=document.querySelector("input:checked").value,s=o.dataset.color,r=o.dataset.number,i="";switch(n){case"tellNumber":i="Informing the aliens about all their "+r+" cards.";break;case"tellColor":i="Informing the aliens about all their <span class='card-color "+s+"'>"+s+"</span> cards.";break;case"play":i="Playing card <span class='card-color "+s+"'>"+s+" "+r+"</span>.";break;case"discard":i="Discarding card <span class='card-color "+s+"'>"+s+" "+r+"</span>."}a(i+" Waiting for a response...",!1),d.onreadystatechange=t,d.open("POST","/gameplay"),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.setRequestHeader("X-Requested-With","XMLHttpRequest"),d.send("action="+n+"&card="+o.dataset.button),e.preventDefault()});var h=function(e){var t={addEvent:function(e,t,n,a){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&(e["e"+t+n]=n,e[t+n]=function(){e["e"+t+n](window.event,a)},e.attachEvent("on"+t,e[t+n]))},input:"",pattern:"38384040373937396665",load:function(e){this.addEvent(document,"keydown",function(n,a){if(a&&(t=a),t.input+=n?n.keyCode:event.keyCode,t.input.length>t.pattern.length&&(t.input=t.input.substr(t.input.length-t.pattern.length)),t.input==t.pattern)return t.code(e),t.input="",n.preventDefault(),!1},this),this.iphone.load(e)},code:function(e){window.location=e},iphone:{start_x:0,start_y:0,stop_x:0,stop_y:0,tap:!1,capture:!1,orig_keys:"",keys:["UP","UP","DOWN","DOWN","LEFT","RIGHT","LEFT","RIGHT","TAP","TAP"],code:function(e){t.code(e)},load:function(e){this.orig_keys=this.keys,t.addEvent(document,"touchmove",function(e){if(1==e.touches.length&&1==t.iphone.capture){var n=e.touches[0];t.iphone.stop_x=n.pageX,t.iphone.stop_y=n.pageY,t.iphone.tap=!1,t.iphone.capture=!1,t.iphone.check_direction()}}),t.addEvent(document,"touchend",function(n){1==t.iphone.tap&&t.iphone.check_direction(e)},!1),t.addEvent(document,"touchstart",function(e){t.iphone.start_x=e.changedTouches[0].pageX,t.iphone.start_y=e.changedTouches[0].pageY,t.iphone.tap=!0,t.iphone.capture=!0})},check_direction:function(e){x_magnitude=Math.abs(this.start_x-this.stop_x),y_magnitude=Math.abs(this.start_y-this.stop_y),x=this.start_x-this.stop_x<0?"RIGHT":"LEFT",y=this.start_y-this.stop_y<0?"DOWN":"UP",result=x_magnitude>y_magnitude?x:y,result=1==this.tap?"TAP":result,result==this.keys[0]&&(this.keys=this.keys.slice(1,this.keys.length)),0==this.keys.length&&(this.keys=this.orig_keys,this.code(e))}}};return"string"==typeof e&&t.load(e),"function"==typeof e&&(t.code=e,t.load()),t};new h(function(){for(var e=document.querySelectorAll("#hand-player .card"),t=0;t<e.length;t++)e[t].className+=" color-known-true number-known-true"});document.addEventListener("keydown",function(e){27===e.keyCode&&(i.className="")});var m=!1;"undefined"!=typeof SpeechSynthesisUtterance&&(document.querySelector(".overlay-read").className="overlay-read");var v=document.getElementById("intro-overlay");v&&(u.style.zIndex=1,u.className="show",u.innerHTML=v.innerHTML)}();