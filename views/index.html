{% extends 'layout.html' %}

{% block content %}

<div class="container">
  <header class='primary-header'>
    <h1 id="title">{{ title }}</h1>
    <div id="game-status">
      <span class='game-score game-status-item'>SCORE  {{ gameState.score }} / 25</span>
      <span class='game-score game-status-item'>TIME  <span class='sr-only'>{{ gameState.timeTokens }}</span>
      {% set timeTokens = Array(gameState.timeTokens) %}
      {% for t in timeTokens %}⌛️{% endfor %}
    </span>
      <span class='game-score game-status-item'>FUSES <span class='sr-only'>{{ gameState.fuseTokens }}</span>
    {% set fuseTokens = Array(gameState.fuseTokens) %}
    {% for t in fuseTokens %}⭐️{% endfor %}    
    </span>
    <a href='/gameplay/reset'>Restart Game</a>
    </div>
  </header>
  
  {% if gameState.gameFinished %}
    
    <h1>The game has come to an end!</h1>
    <p>
      Your score: {{ gameState.score }} out of a possible 25.
    </p>
    <p>
      <a href="/gameplay/reset">Play again?</a>
    </p>

  {% else %}
      
  <form action='/gameplay' method='post'>
    <div id="hand-computer" class="hand playable-hand">
    {% for card in gameState.computer %}
      <button name='card' value='{{ loop.index0 }},computer' class='computer-card card color-show number-show color-known-{{ card.isColorKnown }} number-known-{{  card.isNumberKnown }} color-{{ card.color }} number-{{ card.number }}' draggable='true'>
        👽
        <div class="info">
          
          <span class='hidden'>P:{{ card.canPlay }}</span>
          <span class='hidden'>D:{{ card.canDiscard }}</span>
          <span class="info-color">🎨</span>  
          <span class="info-number">🔢</span>  
          <span class='sr-only'>Is the color known? {{ card.isColorKnown }}</span>
          <span class='sr-only'>Is the number known? {{ card.isNumberKnown }}</span>
        </div>  
      </button>
    {% endfor %}
    </div>
    
    
    <div class='label-container'>
      <label for='play1'><input type="radio" id="play1" name="action" value='tellColor'><span class='play-instructions'>Tell about color</span></label><label for='play2'><input type="radio" id="play2" name="action" value='tellNumber'><span class='play-instructions'>Tell about number</span></label>
    </div>
    
    <h2 class='sr-only'>Played Cards</h2>    
      <ul id="played-cards" class='hnd'>
      {% for color,cards in gameState.played %}<li class='{{ color }}-played'><span class='sr-only'>{{ color }} cards</span>
          <ul>
            <li class='card  color-known-true number-known-true blank-card'>
              <span class='card-decoration'>
                📡<span class='heart'></span>👽      
              </span>
            </li>              
            {% for card in cards %}
        <li class='card color-{{ card.color }} number-{{ card.number }} color-known-true number-known-true'>
          <span class='card-decoration'>
            📡<span class='heart'></span>👽      
          </span>
        </li>  
            {% endfor %}
          </ul>
        </li>{% endfor %}
      </ul>
    
    <div class='label-container'>
      <label for='play3'><input type="radio" id="play3" name="action" value='discard'><span class='play-instructions'>Discard a card</span></label><label for='play4'><input type="radio" id="play4" name="action" value='play' checked><span class='play-instructions'>Play a card</span></label>
    </div>

    <div id="hand-player" class="hand playable-hand">
    {% for card in gameState.player %}
      <button name='card' value='{{ loop.index0 }},player' class='player-card card color-known-{{ card.isColorKnown }} number-known-{{ card.isNumberKnown }} color-{{ card.color }} number-{{ card.number }}' draggable='true'>
        📡
        <div class="info">
          <span class="hidden">P:{{ card.canPlay }}</span>
          <span class="hidden">D:{{ card.canDiscard }}</span>          
          <!-- <span class="info-color">🎨</span>   -->
          <!-- <span class="info-number">🔢</span>   -->
          <span class='sr-only'>Is the color known? {{ card.isColorKnown }}</span>
          <span class='sr-only'>Is the number known? {{ card.isNumberKnown }}</span>
        </div>  
      </button>
      </button>
    {% endfor %}
    </div>
    
  </form>
  
  <h2>Discard Pile</h2>
  
  <ul id='hand-discard' class='hand'>
    {% for card in gameState.discard %}
      <li class='card color-{{ card.color }} number-{{ card.number }} color-known-true number-known-true'></li>  
    {% endfor %}  
  </ul>
  
  <h2>Game Log</h2>
  
  <ol>
    {% for action in gameState.log %}
    <li>{{ action }}</li>
    {% endfor %}
  </ol>
  

{% endif %}

</div>  
  
{% endblock %}
